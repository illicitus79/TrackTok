{% extends "base.html" %} {% block title %}Dashboard - TrackTok{% endblock %} {%
block content %}
<div class="container page-section">
  <div class="page-header">
    <div class="page-title-group">
      <h1 style="font-size: 2rem; margin: 0">Dashboard</h1>
      <p class="page-subtitle">Quick view of spend, projects, and activity.</p>
    </div>
    <div class="page-actions">
      <a href="{{ url_for('web.projects') }}" class="btn btn-primary"
        >New Project</a
      >
      <a href="{{ url_for('web.expense_new') }}" class="btn btn-secondary"
        >Add Expense</a
      >
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="cards-grid">
    <div class="card">
      <div class="card-body">
        <div class="metric-card">
          <div
            class="metric-icon"
            style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
          >
            $
          </div>
          <div>
            <div class="metric-label">Total Expenses (Month)</div>
            <div class="metric-value">
              {{ format_money(monthly_expenses|float) }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-body">
        <div class="metric-card">
          <div
            class="metric-icon"
            style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"
          >
            PRJ
          </div>
          <div>
            <div class="metric-label">Active Projects</div>
            <div class="metric-value">{{ project_count }}</div>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-body">
        <div class="metric-card">
          <div
            class="metric-icon"
            style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"
          >
            #
          </div>
          <div>
            <div class="metric-label">Expenses Count</div>
            <div class="metric-value">{{ expense_count }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Content Grid -->
  <div class="content-grid">
    <!-- Active Projects -->
    <div class="card">
      <div class="card-header">
        <h2 class="card-title" style="margin: 0">Active Projects</h2>
        {% if active_projects %}
        <span class="text-muted">{{ active_projects|length }} active</span>
        {% else %}
        <span class="text-muted">No active projects</span>
        {% endif %}
      </div>
      <div class="card-body">
        {% if active_projects %}
        <div class="tile-stack">
          {% for project in active_projects %}
          <div class="tile">
            <div class="tile-header">
              <div>
                <div class="tile-title">{{ project.name }}</div>
                <div class="tile-subtitle">
                  Budget: {{ format_money(project.starting_budget|float) }}
                </div>
              </div>
              <span class="badge badge-success">{{ project.status }}</span>
            </div>
            {% if project.budget_utilization %}
            <div>
              <div class="tile-meta">
                <span>Utilization</span>
                <span
                  >{{ "%.1f"|format(project.budget_utilization|float) }}%</span
                >
              </div>
              <div class="progress-bar">
                <div
                  class="progress-fill"
                  style="width: {{ project.budget_utilization }}%"
                ></div>
              </div>
            </div>
            {% endif %}
          </div>
          {% endfor %}
        </div>
        {% else %}
        <div class="empty-state">
          <p>No active projects</p>
          <a href="{{ url_for('web.projects') }}" class="btn btn-primary"
            >Create Project</a
          >
        </div>
        {% endif %}
      </div>
    </div>

    <!-- Recent Expenses -->
    <div class="card">
      <div class="card-header">
        <h2 class="card-title" style="margin: 0">Recent Expenses</h2>
        <span class="text-muted">Latest recorded costs</span>
      </div>
      <div class="card-body">
        {% if recent_expenses %}
        <div class="tile-stack">
          {% for expense in recent_expenses %}
          <div class="tile">
            <div class="tile-header">
              <div>
                <div class="tile-title">
                  {{ expense.vendor or expense.note or 'Expense' }}
                </div>
                <div class="tile-subtitle">
                  {{ expense.expense_date.strftime('%b %d, %Y') }} {% if
                  expense.category %} &nbsp;&bull;&nbsp;{{
                  expense.category.name }} {% endif %}
                </div>
              </div>
              <div class="tile-value">
                {{ format_money(expense.amount|float) }}
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
        <div class="card-footer">
          <a href="{{ url_for('web.expenses') }}">View All -></a>
        </div>
        {% else %}
        <div class="empty-state">
          <p>No expenses recorded</p>
          <a href="{{ url_for('web.expenses') }}" class="btn btn-primary"
            >Add Expense</a
          >
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
